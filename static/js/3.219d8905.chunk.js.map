{"version":3,"sources":["webpack:///./src/app/components/Title/Title.css","webpack:///./src/posts/components/PostsList/PostsList.css","webpack:///./src/posts/components/Post/Post.css","webpack:///./node_modules/react-data-wrapper/lib/useStates.js","webpack:///./node_modules/react-data-wrapper/lib/index.js","webpack:///./src/app/components/Title/index.ts","webpack:///./src/app/components/Title/Title.tsx","webpack:///./src/app/components/ErrorLoading/index.ts","webpack:///./src/app/components/ErrorLoading/ErrorLoading.tsx","webpack:///./src/posts/components/Post/index.ts","webpack:///./src/posts/components/Post/Post.tsx","webpack:///./src/posts/components/PostsList/index.ts","webpack:///./src/posts/components/PostsList/PostsList.tsx","webpack:///./src/posts/types.ts","webpack:///./src/posts/stores/PostsStore/services.ts","webpack:///./src/posts/stores/PostsStore/PostsStore.ts","webpack:///./src/posts/stores/PostsStore/index.ts","webpack:///./src/posts/routes/Posts/Posts.tsx","webpack:///./src/posts/routes/Posts/Posts.css"],"names":["module","exports","fsState","state","update","idle","setState","loading","success","failure","__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","memo","isEmpty","fetchFunc","ErrComp","empty","children","_a","load","then","done","catch","error","reload","createElement","onReload","className","root","handle","disabled","onClick","post","title","body","posts","map","key","id","IPost","userId","fetchPosts","data","client","get","fetch","services","forEach","this","set","size","filterPosts","user","onlyMy","filter","setOnlyMy","UserContext","onOnlyMyChange","event","target","checked","header","Boolean","type","onChange","Array","from","values"],"mappings":"kFACAA,EAAOC,QAAU,CAAC,KAAO,c,yBCAzBD,EAAOC,QAAU,CAAC,KAAO,YAAY,KAAO,c,yBCA5CD,EAAOC,QAAU,CAAC,KAAO,YAAY,MAAQ,YAAY,KAAO,c,+CCA5DC,E,sCACJ,SAAWA,GACPA,EAAQA,EAAc,KAAI,GAAK,OAC/BA,EAAQA,EAAiB,QAAI,GAAK,UAClCA,EAAQA,EAAiB,QAAI,GAAK,UAClCA,EAAQA,EAAiB,QAAI,GAAK,UAJtC,CAKGA,IAAYA,EAAU,KAeV,MAdf,WACI,MAAOC,EAAOC,GAAU,mBAASF,EAAQG,MACnCC,EAAW,kBAAQ,KAAM,CAC3B,OAASF,EAAOF,EAAQK,UACxB,OAASH,EAAOF,EAAQM,UACxB,QAAUJ,EAAOF,EAAQO,YACzB,IACJ,MAAO,CACHF,QAASJ,IAAUD,EAAQK,QAC3BC,QAASL,IAAUD,EAAQM,QAC3BC,QAASN,IAAUD,EAAQO,QAC3BH,aCnBJI,EAAkC,SAAUC,EAAGC,GAC/C,IAAIC,EAAI,GACR,IAAK,IAAIC,KAAKH,EAAOI,OAAOC,UAAUC,eAAeC,KAAKP,EAAGG,IAAMF,EAAEO,QAAQL,GAAK,IAC9ED,EAAEC,GAAKH,EAAEG,IACb,GAAS,MAALH,GAAqD,mBAAjCI,OAAOK,sBACtB,KAAIC,EAAI,EAAb,IAAgBP,EAAIC,OAAOK,sBAAsBT,GAAIU,EAAIP,EAAEQ,OAAQD,IAC3DT,EAAEO,QAAQL,EAAEO,IAAM,GAAKN,OAAOC,UAAUO,qBAAqBL,KAAKP,EAAGG,EAAEO,MACvER,EAAEC,EAAEO,IAAMV,EAAEG,EAAEO,KAE1B,OAAOR,GAII,MAAMW,MAAK,UAAqB,QAAEC,EAAO,UAAEC,EAAS,QAAEnB,EAASE,QAASkB,EAAO,MAAEC,EAAK,SAAEC,IACnG,MAAMC,EAAK,KAAa,SAAExB,GAAawB,EAAI3B,EAAQO,EAAOoB,EAAI,CAAC,aAC/D,oBAAU,KACNxB,EAASyB,OACTL,IACKM,KAAK1B,EAAS2B,MACdC,MAAM5B,EAAS6B,QACrB,CAAC7B,IACJ,MAAM8B,EAAS,sBAAY,IAChBV,IAAYM,KAAK1B,EAAS2B,MAClC,CAAC3B,IACJ,QAAQ,GACJ,KAAKH,EAAMI,SAAWkB,EAAS,OAAOlB,EACtC,KAAKJ,EAAMM,QAAS,OAAO,IAAM4B,cAAcV,EAAS,CAAEW,SAAUF,IACpE,KAAKjC,EAAMK,SAAWiB,EAAS,OAAOG,EACtC,KAAKzB,EAAMK,UAAYiB,EAAS,OAAOI,EACvC,QAAS,OAAO,S,uBC3BT,ECEA,IAAML,MACnB,UAAe,SAAEK,IACf,OAAO,wBAAIU,UAAW,IAAIC,MAAOX,MCJtB,ECIA,IAAML,MACnB,UAAsB,SAAEc,IACtB,MAAO/B,EAASH,GAAU,oBAAS,GAE7BqC,EAAS,sBAAY,KACzBrC,GAAO,GACPkC,IAAWJ,MAAM,IAAM9B,GAAO,KAC7B,CAACkC,IAEJ,OACE,6BACE,wDACA,4BAAQI,SAAUnC,EAASoC,QAASF,GAAM,c,4DChBnC,ECUA,aACb,UAAc,KAAEG,EAAI,UAAEL,IACpB,OACE,yBAAKA,UAAW,IAAW,IAAIC,KAAMD,IACnC,wBAAIA,UAAW,IAAIM,OAChBD,EAAKC,OAER,uBAAGN,UAAW,IAAIO,MACfF,EAAKE,U,uBClBD,ECWA,aACb,UAAmB,MAAEC,EAAK,UAAER,IAC1B,OACE,yBAAKA,UAAW,IAAW,IAAIC,KAAMD,IAClCQ,EAAMC,IAAIJ,GACT,kBAAC,EAAI,CACHK,IAAKL,EAAKM,GACVN,KAAMA,EACNL,UAAW,IAAIK,Y,wDCnBpB,MAAMO,EAAQ,WACnB,YAAY,CACVC,OAAQ,SACRF,GAAI,SACJL,MAAO,SACPC,KAAM,Y,0SCGK,OAAEO,WALE,IAAY,OAAD,6BAC5B,MAAMC,QAAaC,EAAA,EAAOC,IAAa,UACvC,OAAO,SAAgB,QAAQL,GAAQG,O,4mBCHzC,MAAM,EAGJ,cAQQ,KAAAG,MAAQ,IAAY,kCAC1B,MAAMV,QAAcW,EAASL,aAC7B,YAAY,KACVN,EAAMY,QAAQf,GAAQgB,KAAKb,MAAMc,IAAIjB,EAAKM,GAAIN,SAVhDgB,KAAKb,MAAQ,IAAWC,IAAI,IAGpB,YACR,OAAQY,KAAKb,MAAMe,MAPT,GAAX,K,4BAMS,GAAT,K,0BAIO,GAAP,K,4BAQY,ICrBA,MDqBA,E,uBEVf,SAASC,EAAYhB,EAAgBiB,EAAoBC,GACvD,OAAOD,GAAQjB,EAAMzB,QAAU2C,EAC3BlB,EAAMmB,OAAOtB,GAAQA,EAAKQ,SAAWY,EAAKd,IAC1CH,EAGS,uBAAS,WACtB,MAAOkB,EAAQE,GAAa,oBAAS,GAE/BH,EAAO,qBAAWI,EAAA,GAElBC,EAAiB,sBAAaC,GAClCH,EAAUG,EAAMC,OAAOC,SACtB,IAEH,OACE,oCACE,yBAAKjC,UAAW,IAAIkC,QAClB,kBAAC,EAAK,cACLC,QAAQV,IACP,+BACE,2BAAOW,KAAK,WAAWH,QAASP,EAAQW,SAAUP,IAClD,iDAIN,kBAAC,EAAW,CACV3C,UAAW,EAAM+B,MACjBhC,QAAS,EAAMG,MACfrB,QAAS,iDACTE,QAAS,EACTmB,MAAO,yCAEP,kBAAC,EAAS,CACRmB,MAAOgB,EACLc,MAAMC,KAAK,EAAM/B,MAAMgC,UACvBf,EACAC,W,uBCjDZjE,EAAOC,QAAU,CAAC,OAAS","file":"static/js/3.219d8905.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"_3gOJhAGP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"_1ptYWwxx\",\"post\":\"_2lnjKkBs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"_3Hh370Di\",\"title\":\"_3efqJP5_\",\"body\":\"_1xNDSxg9\"};","import { useState, useMemo } from 'react';\nvar fsState;\n(function (fsState) {\n    fsState[fsState[\"idle\"] = 0] = \"idle\";\n    fsState[fsState[\"loading\"] = 1] = \"loading\";\n    fsState[fsState[\"success\"] = 2] = \"success\";\n    fsState[fsState[\"failure\"] = 3] = \"failure\";\n})(fsState || (fsState = {}));\nfunction useStates() {\n    const [state, update] = useState(fsState.idle);\n    const setState = useMemo(() => ({\n        load() { update(fsState.loading); },\n        done() { update(fsState.success); },\n        error() { update(fsState.failure); },\n    }), []);\n    return {\n        loading: state === fsState.loading,\n        success: state === fsState.success,\n        failure: state === fsState.failure,\n        setState,\n    };\n}\nexport default useStates;\n//# sourceMappingURL=useStates.js.map","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React, { useEffect, useCallback } from 'react';\nimport useStates from './useStates';\nexport default React.memo(function DataWrapper({ isEmpty, fetchFunc, loading, failure: ErrComp, empty, children, }) {\n    const _a = useStates(), { setState } = _a, state = __rest(_a, [\"setState\"]);\n    useEffect(() => {\n        setState.load();\n        fetchFunc()\n            .then(setState.done)\n            .catch(setState.error);\n    }, [setState]);\n    const reload = useCallback(() => {\n        return fetchFunc().then(setState.done);\n    }, [setState]);\n    switch (true) {\n        case state.loading && isEmpty: return loading;\n        case state.failure: return React.createElement(ErrComp, { onReload: reload });\n        case state.success && isEmpty: return empty;\n        case state.success && !isEmpty: return children;\n        default: return null;\n    }\n});\n//# sourceMappingURL=index.js.map","import Title from './Title';\n\nexport default Title;\n","import React from 'react';\n\nimport css from './Title.css';\n\nexport default React.memo(\n  function Title({ children }) {\n    return <h1 className={css.root}>{children}</h1>;\n  }\n);\n","import ErrorLoading from './ErrorLoading';\n\nexport default ErrorLoading;\n","import React, { useState, useCallback } from 'react';\n\ninterface IProps {\n  onReload: () => Promise<void>;\n}\n\nexport default React.memo<IProps>(\n  function ErrorLoading({ onReload }) {\n    const [loading, update] = useState(false);\n\n    const handle = useCallback(() => {\n      update(true);\n      onReload().catch(() => update(false));\n    }, [onReload]);\n\n    return (\n      <div>\n        <span>Something went wrong, </span>\n        <button disabled={loading} onClick={handle}>\n          reload\n        </button>\n      </div>\n    );\n  }\n);\n","import Post from './Post';\n\nexport default Post;\n","import React from 'react';\nimport { observer } from 'mobx-react-lite';\nimport classNames from 'classnames';\nimport { IPost } from 'posts/types';\n\nimport css from './Post.css';\n\ninterface IProps {\n  post: IPost;\n  className?: string;\n}\n\nexport default observer<IProps>(\n  function Post({ post, className }) {\n    return (\n      <div className={classNames(css.root, className)}>\n        <h3 className={css.title}>\n          {post.title}\n        </h3>\n        <p className={css.body}>\n          {post.body}\n        </p>\n      </div>\n    );\n  }\n);\n","import PostsList from './PostsList';\n\nexport default PostsList;\n","import React from 'react';\nimport { observer } from 'mobx-react-lite';\nimport classNames from 'classnames';\nimport { IPost } from 'posts/types';\nimport Post from '../Post';\n\nimport css from './PostsList.css';\n\ninterface IProps {\n  posts: IPost[];\n  className?: string;\n}\n\nexport default observer<IProps>(\n  function PostsList({ posts, className }) {\n    return (\n      <div className={classNames(css.root, className)}>\n        {posts.map(post => (\n          <Post\n            key={post.id}\n            post={post}\n            className={css.post}\n          />\n        ))}\n      </div>\n    );\n  }\n);\n","import * as t from 'io-ts';\n\nexport const IPost = t.readonly(\n  t.interface({\n    userId: t.number,\n    id: t.number,\n    title: t.string,\n    body: t.string,\n  })\n);\n\nexport type IPost = t.TypeOf<typeof IPost>;\n","import * as t from 'io-ts';\nimport * as tPromise from 'io-ts-promise';\nimport client from 'client';\nimport { IPost } from 'posts/types';\n\nconst fetchPosts = async () => {\n  const data = await client.get<IPost[]>('/posts');\n  return tPromise.decode(t.array(IPost), data);\n};\n\nexport default { fetchPosts };\n","import { action, observable, computed, ObservableMap, runInAction } from 'mobx';\nimport { IPost } from 'posts/types';\nimport services from './services';\n\nclass PostsStore {\n  @observable posts: ObservableMap<number, IPost>;\n\n  constructor() {\n    this.posts = observable.map({});\n  }\n\n  @computed get empty() {\n    return !this.posts.size;\n  }\n\n  @action fetch = async () => {\n    const posts = await services.fetchPosts();\n    runInAction(() => {\n      posts.forEach(post => this.posts.set(post.id, post));\n    });\n  };\n}\n\nexport default PostsStore;\n","import PostsStore from './PostsStore';\n\nexport default new PostsStore();\n","import React, { useState, useContext, useCallback } from 'react';\nimport { observer } from 'mobx-react-lite';\nimport DataWrapper from 'react-data-wrapper';\nimport Title from 'app/components/Title';\nimport ErrorLoading from 'app/components/ErrorLoading';\nimport UserContext from 'app/contexts/UserContext';\nimport { IUser } from 'app/types';\nimport PostsList from 'posts/components/PostsList';\nimport store from 'posts/stores/PostsStore';\nimport { IPost } from 'posts/types';\n\nimport css from './Posts.css';\n\nfunction filterPosts(posts: IPost[], user: IUser | null, onlyMy: boolean): IPost[] {\n  return user && posts.length && onlyMy\n    ? posts.filter(post => post.userId === user.id)\n    : posts;\n}\n\nexport default observer(function Posts() {\n  const [onlyMy, setOnlyMy] = useState(false);\n\n  const user = useContext(UserContext);\n\n  const onOnlyMyChange = useCallback((event) => (\n    setOnlyMy(event.target.checked)\n  ), []);\n\n  return (\n    <>\n      <div className={css.header}>\n        <Title>Posts</Title>\n        {Boolean(user) && (\n          <label>\n            <input type=\"checkbox\" checked={onlyMy} onChange={onOnlyMyChange} />\n            <span>Only my posts</span>\n          </label>\n        )}\n      </div>\n      <DataWrapper\n        fetchFunc={store.fetch}\n        isEmpty={store.empty}\n        loading={<div>Loading posts...</div>}\n        failure={ErrorLoading}\n        empty={<div>No data</div>}\n      >\n        <PostsList\n          posts={filterPosts(\n            Array.from(store.posts.values()),\n            user,\n            onlyMy,\n          )}\n        />\n      </DataWrapper>\n    </>\n  );\n});\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"zGVB3LFj\"};"],"sourceRoot":""}